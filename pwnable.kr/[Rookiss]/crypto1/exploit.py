from pwn import *
import hashlib

def getCookie(id, pw):
    r = remote('pwnable.kr', 9006)
    r.sendlineafter('ID', id)
    r.sendlineafter('PW', pw)
    r.recvuntil('(')
    enc = r.recvuntil(')')[:-1]
    return enc

cookie = ''

for i in range(2, 100):
    for j in '1234567890abcdefghijklmnopqrstuvwxyz-_':
        enc1 = getCookie('-'*(15-(i % 16)) + '--' + cookie + j, '')
        enc2 = getCookie('-'*(15-(i % 16)), '')
        if enc1[:32*(i//16+1)] == enc2[:32*(i//16+1)]:
            cookie += j
            print(cookie)
            break
        if j == '_':
            id = 'admin'
            pw = hashlib.sha256((id+cookie).encode()).hexdigest()
            r = remote('pwnable.kr', 9006)
            r.sendlineafter('ID', id)
            r.sendlineafter('PW', pw)
            r.recvuntil('flag\n')
            print(r.recv().strip().decode())
            exit(0)