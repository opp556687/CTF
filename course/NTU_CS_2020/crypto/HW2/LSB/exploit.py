from pwn import *
from Crypto.Util.number import *

p = process(['python3', 'server.py'])
# p = remote('140.112.31.97', 30001)
n = int(p.recvline().split(b' = ')[1])
c = int(p.recvline().split(b' = ')[1])

L = 0
H = n
e = 65537
_3e = pow(3, e, n)
for _ in range(1024):
    diff = (H-L)//3
    c = (_3e * c) % n
    p.sendline(str(c))
    r = int(p.recvline().split(b' = ')[1])
    if r == 0:
        H = L+diff
    elif r == (-n)%3:
        L = L+diff
        H = H-diff
    else:
        L = H-diff
print(long_to_bytes(L))
print(long_to_bytes(H))