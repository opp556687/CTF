from pwn import *

#p = process('./challenge')
p = remote('svc.pwnable.xyz', 30031)
elf = ELF('./challenge')

target = [0x11, 0xDE, 0xCF, 0x10, 0xDF, 0x75, 0xBB, 0xA5, 0x43, 0x1E,
          0x9D, 0xC2, 0xE3, 0xBF, 0xF5, 0xD6, 0x96, 0x7F, 0xBE, 0xB0,
          0xBF, 0xB7, 0x96, 0x1D, 0xA8, 0xBB, 0x0A, 0xD9, 0xBF, 0xC9,
          0x0D, 0xFF]

name = b''
for idx in range(len(target)):
    for i in range(256):
        if (((i>>4) | (16*i)) & 0xff ^ int.from_bytes(elf.read(elf.sym['main']+idx, 1), 'big')) == target[idx]:
            name += bytes([i])

p.sendlineafter('> ', '1')
p.sendafter('name: ', name)

p.sendlineafter('> ', '4')

p.interactive()